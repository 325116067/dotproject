if (@$AppUI->getPref( 'TABVIEW' ) == 0) {
<table border="0" cellpadding="2" cellspacing="0" width="100%">
	<tr>
		<td nowrap="nowrap">
			<a href="{$current_url}&tab=0">{dPtranslate word='tabbed'}</a> : 
			<a href="{$current_url}&tab=-1">{dPtranslate word='flat'}</a>
		</td>
		{$extra}
	</tr>
</table>

{else}
	{if $extra}
<table border="0" cellpadding="2" cellspacing="0" width="100%">
	<tr>
		{$extra}
	</tr>
</table>
	{else}
	<img src="./images/shim.gif" height="10" width="1" />
	{/if}
{/if}

		if ($this->active < 0 || @$AppUI->getPref( 'TABVIEW' ) == 2 ) {
		// flat view, active = -1
<table border="0" cellpadding="2" cellspacing="0" width="100%">
{foreach from=$tabs item=v key=k}
	<tr>
		<td><strong>{if $v[2]}{$v[1]}{else}{dPtranslate word=$v[1]}{/if}</strong></td>
	</tr>
	<tr>
		<td>
		{php}
				$currentTabId = $k;
				$currentTabName = $v[1];
				include $this->baseInc.$v[0].".php";
		{/php}
		</td>
	</tr>
{/foreach}
</table>
{else}
{* tabbed view *}
<table width="100%" border="0" cellpadding="3" cellspacing="0">
	<tr>
			if ( count($this->tabs)-1 < $this->active ) {
				//Last selected tab is not available in this view. eg. Child tasks
				$this->active = 0;
			}
{foreach from=$tabs item=v key=k}

		<td width="1%" nowrap="nowrap" class="tabsp">
			<img src="./images/shim.gif" height="1" width="1" alt="" />
		</td>
		<td id="toptab_{$k}" width="1%" nowrap="nowrap"{if $js_tabs} class="{if $k == $active}tabon{else}taboff{/if}"{/if}>
			<a href="
	{if $javascript}
javascript:{$javascript}({$active}, {$k})
	{elseif $js_tabs}
javascript:show_tab({$k})
	{else}
{$current_url}&tab={$k}
	{/if}
">{if $v[2]}{$v[1]}{else}{dPtranslate word=$v[1]}{/if}</a>
		</td>
{/foreach}
		<td nowrap="nowrap" class="tabsp">&nbsp;</td>
	</tr>
	<tr>
		<td width="100%" colspan="'.(count($this->tabs)*2 + 1).'" class="tabox">
			
			//Will be null if the previous selection tab is not available in the new window eg. Children tasks
			if ( $this->baseInc.$this->tabs[$this->active][0] != "" ) {
				$currentTabId = $this->active;
				$currentTabName = $this->tabs[$this->active][1];
				if (!$js_tabs)
					require $this->baseInc.$this->tabs[$this->active][0].'.php';
			}
{if $js_tabs}
	{foreach from=$tabs item=v key=k} 
	<div class="tab" id="tab_{$k}">
					require $this->baseInc.$v[0].'.php';
	</div>
	{/foreach}
{/if}
		</td>
	</tr>
</table>